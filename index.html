<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Russisch Trainer Spalten</title>
    <style>
        :root {
            --primary: #007AFF; --bg: #F2F2F7; --card: #FFF; --text: #000; --sub: #8E8E93;
            --danger: #FF3B30; --success: #34C759; --radius: 16px; --shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg); color: var(--text); margin: 0; padding: 0;
            overscroll-behavior: none; height: 100vh; height: 100dvh; display: flex; flex-direction: column;
        }
        .nav-tabs {
            background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            height: 50px; display: flex; border-bottom: 1px solid rgba(0,0,0,0.1);
            position: sticky; top: 0; z-index: 100; padding-top: env(safe-area-inset-top);
        }
        .tab-btn { flex: 1; border: none; background: transparent; font-size: 15px; font-weight: 600; color: var(--sub); cursor: pointer; }
        .tab-btn.active { color: var(--primary); }
        .content-area { flex: 1; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        .tab-content { display: none; height: 100%; flex-direction: column; padding: 16px; overflow-y: auto; }
        .tab-content.active { display: flex; }
        .game-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-shrink: 0; }
        
        /* NEUE ZWEI-SPALTEN STRUKTUR */
        .game-grid {
            display: grid; 
            grid-template-columns: 1fr 1fr; /* Links = Russisch, Rechts = Englisch */
            grid-template-rows: repeat(5, 1fr); /* 5 Paare = 5 Zeilen */
            gap: 12px; 
            flex: 1; 
            height: 100%; 
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .card {
            background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            text-align: center; cursor: pointer; position: relative; border: 2px solid transparent;
            transition: transform 0.1s; touch-action: manipulation; height: 100%; width: 100%;
        }
        .card:active { transform: scale(0.96); }
        .card.selected { border-color: var(--primary); background-color: #E5F1FF; }
        .card.matched { background-color: var(--success); border-color: var(--success); opacity: 0.2; pointer-events: none; }
        .card.error { background-color: var(--danger); border-color: var(--danger); animation: shake 0.4s; }
        .card.error .card-text, .card.error .speaker-icon { color: white; }
        .card-text { font-size: clamp(14px, 2vh, 18px); font-weight: 600; line-height: 1.3; padding: 0 5px; }
        .speaker-icon { color: var(--sub); margin-top: 6px; width: 20px; height: 20px; }
        .card.selected .speaker-icon { color: var(--primary); }
        .btn { background: var(--primary); color: white; border: none; padding: 8px 16px; border-radius: 20px; font-weight: 600; cursor: pointer; }
        .vocab-item { padding: 12px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; background: white; }
        .vocab-list { background: white; border-radius: var(--radius); overflow: hidden; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .stat-card { background: white; padding: 20px; border-radius: var(--radius); text-align: center; box-shadow: var(--shadow); }
        .stat-num { font-size: 28px; font-weight: 700; display: block; }
        @keyframes shake { 0%,100% {transform:translateX(0)} 25% {transform:translateX(-5px)} 75% {transform:translateX(5px)} }
        @keyframes fadeIn { from {opacity:0;transform:scale(0.9)} to {opacity:1;transform:scale(1)} }
    </style>
</head>
<body>
<nav class="nav-tabs">
    <button class="tab-btn active" onclick="app.switchTab('game')">Spiel</button>
    <button class="tab-btn" onclick="app.switchTab('weak')">Training</button>
    <button class="tab-btn" onclick="app.switchTab('manage')">Liste</button>
    <button class="tab-btn" onclick="app.switchTab('stats')">Profil</button>
</nav>
<div class="content-area">
    <div id="tab-game" class="tab-content active">
        <div class="game-header">
            <div style="color:#8E8E93; font-weight:500" id="gameProgress">0 / 5 Paare</div>
            <button class="btn" onclick="app.startNewGame('normal')">Neu Mischen ↻</button>
        </div>
        <div id="gameBoard" class="game-grid"></div>
    </div>
    <div id="tab-weak" class="tab-content">
        <div class="game-header">
            <div><strong>Fehler üben</strong><br><span style="color:#8E8E93" id="weakCountDisplay">0 Wörter</span></div>
            <button class="btn" id="btnStartWeak" onclick="app.startNewGame('weak')">Starten ▶</button>
        </div>
        <div id="weakBoard" class="game-grid" style="border: 2px dashed #ddd; border-radius: 16px; display:flex; justify-content:center; align-items:center; color:#999">
            Hier erscheinen deine Übungen.
        </div>
    </div>
    <div id="tab-manage" class="tab-content">
        <input type="text" id="searchInput" placeholder="Suchen..." style="width:100%; padding:12px; border:none; background:#e3e3e8; border-radius:10px; margin-bottom:15px" onkeyup="app.renderVocabList()">
        <div class="vocab-list" id="vocabListContainer"></div>
    </div>
    <div id="tab-stats" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card"><span class="stat-num" style="color:var(--primary)" id="statTotalWords">0</span><span style="font-size:13px;color:#8E8E93">GESAMT</span></div>
            <div class="stat-card"><span class="stat-num" style="color:var(--success)" id="statPairsFound">0</span><span style="font-size:13px;color:#8E8E93">GELÖST</span></div>
            <div class="stat-card"><span class="stat-num" id="statRounds">0</span><span style="font-size:13px;color:#8E8E93">RUNDEN</span></div>
            <div class="stat-card"><span class="stat-num" style="color:var(--danger)" id="statErrors">0</span><span style="font-size:13px;color:#8E8E93">FEHLER</span></div>
        </div>
        <div style="margin-top:auto; gap:10px; display:flex; flex-direction:column; padding-top:20px">
            <button class="btn" style="background:#8E8E93" onclick="app.resetStats()">Statistik Reset</button>
            <button class="btn" style="background:var(--danger)" onclick="app.hardReset()">Alles Löschen</button>
        </div>
    </div>
</div>
<script>
const RAW_VOCAB = [
["красивое","beautiful"],["большое","big"],["маленькое","small"],["хорошее","good"],["место","place"],
["правило","rule"],["большую","big"],["плохую","bad"],["плохой","bad"],["старший","older"],
["младший","younger"],["старшая","older"],["мысль","idea"],["странный","strange"],["умный","smart"],
["младшая","younger"],["декабрь","December"],["конец","end"],["начало","beginning"],["март","March"],
["просто","simply"],["бросать","throw"],["тренироваться","to train"],["бежать","run"],["ноябрь","November"],
["отпуск","vacation"],["октябрь","October"],["июль","July"],["июнь","June"],["сентябрь","September"],
["август","August"],["четырнадцать","fourteen"],["море","sea"],["запад","west"],["восток","east"],
["юг","south"],["шумно","noisy"],["солнце","sun"],["тихо","quiet"],["туман","fog"],
["новую","new"],["хорошую","good"],["длинную","long"],["твою","your"],["целый","whole"],
["длинный","long"],["важный","important"],["красивый","beautiful"],["тринадцать","thirteen"],["девятнадцать","nineteen"],
["восемнадцать","eighteen"],["семнадцать","seventeen"],["апрель","April"],["май","May"],["двенадцать","twelve"],
["было","was"],["спорт","sport"],["выиграть","to win"],["проиграть","to lose"],["форма","uniform"],
["хоккей","hockey"],["надевать","to put on"],["матч","match"],["футболист","soccer player"],["завтра","tomorrow"],
["будет","will be"],["вчера","yesterday"],["скоро","soon"],["месяц","month"],["февраль","February"],
["январь","January"],["команда","team"],["футбольный","soccer"],["стадион","stadium"],["игра","game"],
["баскетболист","basketball player"],["звезда","star"],["север","north"],["прекрасный","beautiful"],["сад","garden"],
["минус","minus"],["плюс","plus"],["туча","rain cloud"],["градус","degrees"],["ветер","wind"],
["температура","temperature"],["сильный","strong"],["небо","sky"],["грязно","dirty"],["зима","winter"],
["осень","fall"],["лето","summer"],["цветы","flowers"],["весна","spring"],["тепло","warm"],
["холодно","cold"],["снег","snow"],["идти","to go"],["дождь","rain"],["твой","your"],
["скажи","tell"],["соседи","neighbors"],["дорогой","dear"],["бизнесмен","businessman"],["сосед","neighbor"],
["учусь","learning"],["работа","work"],["старик","old man"],["группа","group"],["человека","person"],
["опыт","experience"],["учится","study"],["скажите","say"],["бабушка","grandmother"],["племянник","nephew"],
["дедушка","grandfather"],["внучка","granddaughter"],["подросток","teenager"],["сыновья","sons"],["своих","your"],
["родителей","parents"],["будут","will be"],["университет","university"],["студентка","student"],["студент","student"],
["имя","name"],["вашего","your"],["директора","director"],["дочь","daughter"],["свою","your, her, mine"],
["мать","mother"],["отец","father"],["сын","son"],["отца","father's"],["матери","mother's"],
["шестнадцать","sixteen"],["тридцать","thirty"],["пятнадцать","fifteen"],["минут","minutes"],["минута","minute"],
["одиннадцать","eleven"],["сорок","forty"],["двадцать","twenty"],["девять","nine"],["ему","him"],
["год","year"],["окно","window"],["времени","time"],["были","were"],["видел","saw"],
["работала","worked"],["уходить","leave"],["пять","five"],["девочек","girls"],["кошек","cats"],
["шесть","six"],["собак","dogs"],["время","time"],["часов","hours"],["ей","her"],
["мало","few"],["одно","one"],["тебе","you"],["родитель","parent"],["свой","own"],
["дочери","daughter"],["муж","husband"],["жена","wife"],["дядя","uncle"],["прости","sorry"],
["твои","your"],["восемь","eight"],["приходить","come"],["сколько","how many"],["лет","years"],
["семь","seven"],["десять","ten"],["опаздывать","be late"],["возможность","opportunity"],["просить","ask"],
["туда","there"],["отдыхает","rests"],["иногда","sometimes"],["ходит","walks"],["играть","play"],
["никогда","never"],["днём","daytime"],["сплю","sleep"],["расти","grow"],["журнал","magazine"],
["отвечать","answer"],["вместе","together"],["смотреть","watch"],["теннис","tennis"],["мыть","wash"],
["футбол","soccer"],["скрипка","violin"],["баскетбол","basketball"],["снова","again"],["пианино","piano"],
["газета","newspaper"],["спрашивать","ask"],["открывать","open"],["ел","ate"],["весь","whole"],
["помогать","help"],["терять","lose"],["вспоминать","remember"],["забывать","forget"],["переводить","translate"],
["танцевать","dance"],["бежу","run"],["живу","live"],["говорю","speak"],["слушаю","listen"],
["кино","cinema"],["театр","theater"],["музей","museum"],["комната","room"],["дом","house"],
["квартира","apartment"],["кухня","kitchen"],["спальня","bedroom"],["гостиная","living room"],["ванная","bathroom"],
["балкон","balcony"],["крыша","roof"],["лестница","stairs"],["двери","doors"],["дверь","door"],
["стол","table"],["стул","chair"],["кровать","bed"],["диван","sofa"],["полка","shelf"],
["шкаф","wardrobe"],["картина","picture"],["зеркало","mirror"],["лампа","lamp"],["ковер","carpet"],
["растение","plant"],["цветок","flower"],["книга","book"],["рисунок","drawing"],["фотография","photo"],
["мобильный телефон","mobile phone"],["компьютер","computer"],["телевизор","TV"],["радио","radio"],["кнопка","button"],
["часы","watch"],["вешалка","hanger"],["пульт","remote"],["выключатель","switch"],["розетка","socket"],
["провод","wire"],["тарелка","plate"],["чашка","cup"],["стакан","glass"],["ложка","spoon"],
["вилка","fork"],["нож","knife"],["кастрюля","pot"],["сковорода","pan"],["печь","stove"],
["холодильник","fridge"],["стиральная машина","washing machine"],["посудомоечная машина","dishwasher"],["микроволновая печь","microwave"],["хлеб","bread"],
["масло","butter"],["сыр","cheese"],["яйцо","egg"],["мясо","meat"],["рыба","fish"],
["курица","chicken"],["молоко","milk"],["йогурт","yogurt"],["мороженое","ice cream"],["сахар","sugar"],
["соль","salt"],["специя","spice"],["перец","pepper"],["картофель","potato"],["морковь","carrot"],
["лук","onion"],["чеснок","garlic"],["помидор","tomato"],["огурец","cucumber"],["яблоко","apple"],
["апельсин","orange"],["банан","banana"],["лимон","lemon"],["виноград","grapes"],["клубника","strawberry"],
["черника","blueberry"],["малина","raspberry"],["кокос","coconut"],["грецкий орех","walnut"],["кофе","coffee"],
["чай","tea"],["сок","juice"],["вода","water"],["вино","wine"],["пиво","beer"],
["хотеть","want"],["нравиться","like"],["давать","give"],["брать","take"],["делать","do"],
["знать","know"],["понимать","understand"],["видеть","see"],["слышать","hear"],["верить","believe"],
["сомневаться","doubt"],["думать","think"],["мечтать","dream"],["помнить","remember"],["забыть","forget"],
["любить","love"],["ненавидеть","hate"],["бояться","fear"],["смеяться","laugh"],["плакать","cry"],
["улыбаться","smile"],["кричать","shout"],["шептать","whisper"],["петь","sing"],["писать","write"],
["читать","read"],["рисовать","draw"],["учить","teach"],["учиться","study"],["тренировать","train"],
["начинать","begin"],["кончать","finish"],["продолжать","continue"],["переставать","stop"],["пытаться","try"],
["выполнять","perform"],["находится","located"],["украина","Ukraine"],["около","near"],["улице","street"],
["этой","this"],["страна","country"],["об","about"],["улица","street"],["хожу","walk"],
["ходить","walk"],["отдыхать","relax"],["нравится","likes"],["людей","people"],["люди","people"],
["петербург","Petersburg"],["тут","here"],["по-русски","Russian"],["говорит","speaks"],["река","river"],
["большой","big"],["гостиница","hotel"],["больше","bigger"],["заказывать","order"],["концерт","concert"],
["спектакль","show"],["турист","tourist"],["классический","classical"],["впереди","ahead"],["экскурсия","tour"],
["выставка","exhibition"],["галерея","gallery"],["совсем","completely"],["по-немецки","German"],["по-английски","English"],
["без","without"],["европе","Europe"],["ехать","go"],["европа","Europe"],["цирк","circus"],
["главный","main"],["животное","animal"],["зал","hall"],["домашний","home/pet"],["зоопарк","zoo"],
["лес","forest"],["киоск","kiosk"],["пол","floor"],["мост","bridge"],["обсуждать","discuss"]
];

const app = {
    data: { vocab: [], stats: { rounds: 0, pairsFound: 0, totalErrors: 0 } },
    state: { cards: [], selected: null, locked: false, matches: 0, totalPairs: 0, mode: 'normal' },

    init() {
        const stored = localStorage.getItem('ru_trainer_column_v3');
        if (stored) this.data = JSON.parse(stored);
        else this.data.vocab = RAW_VOCAB.map(p => ({ russian: p[0], english: p[1], errors: 0 }));
        this.updateUI();
        this.startNewGame('normal');
    },
    save() { localStorage.setItem('ru_trainer_column_v3', JSON.stringify(this.data)); this.updateUI(); },
    
    switchTab(id) {
        document.querySelectorAll('.tab-btn, .tab-content').forEach(e => e.classList.remove('active'));
        document.querySelectorAll('.tab-btn')[['game','weak','manage','stats'].indexOf(id)].classList.add('active');
        document.getElementById('tab-'+id).classList.add('active');
    },

    startNewGame(mode) {
        this.state.mode = mode; 
        this.state.matches = 0; 
        this.state.selected = null; 
        this.state.locked = false;
        
        let pool = (mode === 'weak') ? this.data.vocab.filter(v => v.errors > 0) : [...this.data.vocab];
        if (pool.length === 0) return mode === 'weak' ? alert("Keine Fehler!") : null;
        
        // Shuffle & Pick 5 pairs
        pool.sort(() => Math.random() - 0.5);
        const selection = pool.slice(0, 5);
        this.state.totalPairs = selection.length;

        // WICHTIG: Russisch und Englisch separat shufflen für Spalten-Layout
        let russianCards = selection.map(w => ({ id: w.russian, text: w.russian, type: 'ru', ref: w }));
        let englishCards = selection.map(w => ({ id: w.russian, text: w.english, type: 'en', ref: w }));
        
        // Jede Spalte für sich mischen
        russianCards.sort(() => Math.random() - 0.5);
        englishCards.sort(() => Math.random() - 0.5);
        
        // Im Grid: Zeile 1 links Russisch, rechts Englisch, etc.
        this.state.cards = [];
        for(let i = 0; i < 5; i++) {
            this.state.cards.push(russianCards[i]);  // Links
            this.state.cards.push(englishCards[i]);  // Rechts
        }
        
        const board = document.getElementById(mode === 'weak' ? 'weakBoard' : 'gameBoard');
        if(mode === 'weak') board.style.display = 'grid';
        this.renderBoard(board);
        document.getElementById('gameProgress').textContent = `0 / ${this.state.totalPairs} Paare`;
        if(mode === 'normal') this.data.stats.rounds++;
        this.save();
    },

    renderBoard(container) {
        container.innerHTML = '';
        this.state.cards.forEach((c, i) => {
            const el = document.createElement('div');
            el.className = 'card';
            el.style.animation = `fadeIn 0.3s ease backwards ${i * 0.05}s`;
            el.innerHTML = `<div class="card-text">${c.text}</div>` + 
                (c.type === 'ru' ? `<svg class="speaker-icon" fill="currentColor" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>` : '');
            el.onclick = () => {
                if(c.type === 'ru') { window.speechSynthesis.cancel(); let u = new SpeechSynthesisUtterance(c.text); u.lang='ru-RU'; window.speechSynthesis.speak(u); }
                if(!this.state.locked && !el.classList.contains('matched') && this.state.selected?.el !== el) {
                    el.classList.add('selected');
                    if(!this.state.selected) this.state.selected = { el, data: c };
                    else this.checkMatch(this.state.selected, { el, data: c });
                }
            };
            container.appendChild(el);
        });
    },

    checkMatch(c1, c2) {
        this.state.locked = true;
        if (c1.data.id === c2.data.id) {
            setTimeout(() => {
                c1.el.classList.replace('selected','matched'); c2.el.classList.replace('selected','matched');
                this.state.matches++; this.data.stats.pairsFound++; 
                document.getElementById('gameProgress').textContent = `${this.state.matches} / ${this.state.totalPairs} Paare`;
                this.state.selected = null; this.state.locked = false; this.save();
                if(this.state.matches === this.state.totalPairs) setTimeout(() => {
                    if(confirm("Runde fertig! Weiter?")) this.startNewGame(this.state.mode);
                }, 300);
            }, 300);
        } else {
            c1.el.classList.add('error'); c2.el.classList.add('error');
            this.data.vocab.find(v => v.russian === c1.data.ref.russian).errors++;
            this.data.stats.totalErrors++; this.save();
            setTimeout(() => {
                c1.el.classList.remove('selected','error'); c2.el.classList.remove('selected','error');
                this.state.selected = null; this.state.locked = false;
            }, 800);
        }
    },

    updateUI() {
        document.getElementById('statTotalWords').textContent = this.data.vocab.length;
        document.getElementById('statRounds').textContent = this.data.stats.rounds;
        document.getElementById('statPairsFound').textContent = this.data.stats.pairsFound;
        document.getElementById('statErrors').textContent = this.data.stats.totalErrors;
        const weakCount = this.data.vocab.filter(v => v.errors > 0).length;
        document.getElementById('weakCountDisplay').textContent = `${weakCount} Wörter`;
        document.getElementById('btnStartWeak').style.opacity = weakCount ? 1 : 0.5;
    },

    renderVocabList() {
        const q = document.getElementById('searchInput').value.toLowerCase();
        const list = document.getElementById('vocabListContainer'); list.innerHTML = '';
        this.data.vocab.filter(v => v.russian.toLowerCase().includes(q) || v.english.toLowerCase().includes(q))
            .slice(0, 50).forEach(v => {
                const d = document.createElement('div'); d.className = 'vocab-item';
                d.innerHTML = `<div><strong>${v.russian}</strong><br><small>${v.english}</small></div>` +
                    (v.errors ? `<div style="background:var(--danger);color:#fff;padding:2px 8px;border-radius:8px;font-size:12px">${v.errors}</div>` : '');
                list.appendChild(d);
            });
    },
    resetStats() { if(confirm('Reset Stats?')) { this.data.stats={rounds:0,pairsFound:0,totalErrors:0}; this.data.vocab.forEach(v=>v.errors=0); this.save(); } },
    hardReset() { if(confirm('Alles Löschen?')) { localStorage.removeItem('ru_trainer_column_v3'); location.reload(); } }
};
document.addEventListener('DOMContentLoaded', () => app.init());
</script>
</body>
</html>
